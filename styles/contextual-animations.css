/**
 * The Tribunal - Contextual Animations
 * State-based animations for tabs and FABs
 * 
 * NOTE: These animations target the EXISTING icons (the `i` element inside tabs).
 * Your current Font Awesome icons stay exactly as they are - we're just adding
 * transform/filter animations to them based on game state.
 * 
 * Toggle these classes via JS when conditions are met:
 * 
 * TABS:
 *   .voices-generating    - Brain "thinking" animation
 *   .voices-ready        - New voices waiting to be seen
 *   .thought-ready       - Thought ready to internalize
 *   .thought-discovered  - New thought just discovered
 *   .health-low          - Health below 30%
 *   .health-critical     - Health below 15%
 *   .morale-low          - Morale below 30%
 *   .condition-active    - Has active status effects
 *   .case-updated        - New case activity
 *   .item-added          - Item just added to inventory
 * 
 * FABS:
 *   .has-notification    - Something needs attention
 *   .urgent              - Critical state (health/morale low)
 *   .scanning            - Investigation in progress
 */

/* ═══════════════════════════════════════════════════════════════
   KEYFRAME DEFINITIONS
   ═══════════════════════════════════════════════════════════════ */

/* Gentle pulse - for "something ready" states */
@keyframes gentle-pulse {
    0%, 100% { 
        transform: scale(1); 
        filter: brightness(1);
    }
    50% { 
        transform: scale(1.08); 
        filter: brightness(1.15);
    }
}

/* Heartbeat - for health/vitals */
@keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    14% { transform: scale(1.15); }
    28% { transform: scale(1); }
    42% { transform: scale(1.1); }
    56% { transform: scale(1); }
}

/* Fast heartbeat - critical health */
@keyframes heartbeat-fast {
    0%, 100% { transform: scale(1); }
    10% { transform: scale(1.2); }
    20% { transform: scale(1); }
    30% { transform: scale(1.15); }
    40% { transform: scale(1); }
}

/* Thinking wobble - for processing/generating */
@keyframes thinking {
    0%, 100% { transform: rotate(0deg) scale(1); }
    25% { transform: rotate(-5deg) scale(1.02); }
    75% { transform: rotate(5deg) scale(1.02); }
}

/* Glow pulse - for "new content" states */
@keyframes glow-pulse {
    0%, 100% { 
        box-shadow: 0 0 0 0 currentColor;
        filter: drop-shadow(0 0 0 transparent);
    }
    50% { 
        box-shadow: 0 0 12px 2px currentColor;
        filter: drop-shadow(0 0 6px currentColor);
    }
}

/* Shake - for discoveries/alerts */
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-3px) rotate(-2deg); }
    40% { transform: translateX(3px) rotate(2deg); }
    60% { transform: translateX(-2px) rotate(-1deg); }
    80% { transform: translateX(2px) rotate(1deg); }
}

/* Page flip - for ledger updates */
@keyframes page-flip {
    0% { transform: perspective(400px) rotateY(0deg); }
    50% { transform: perspective(400px) rotateY(-15deg); }
    100% { transform: perspective(400px) rotateY(0deg); }
}

/* Float/bob - gentle ambient */
@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-2px); }
}

/* Sparkle - for special states */
@keyframes sparkle {
    0%, 100% { 
        filter: brightness(1) saturate(1);
    }
    25% { 
        filter: brightness(1.3) saturate(1.2);
    }
    50% { 
        filter: brightness(1) saturate(1);
    }
    75% { 
        filter: brightness(1.2) saturate(1.1);
    }
}

/* Urgent pulse - for critical states */
@keyframes urgent-pulse {
    0%, 100% { 
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(192, 57, 43, 0);
    }
    50% { 
        transform: scale(1.05);
        box-shadow: 0 0 15px 3px rgba(192, 57, 43, 0.6);
    }
}

/* Paper rustle - for investigation */
@keyframes paper-rustle {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-2deg) translateY(-1px); }
    75% { transform: rotate(2deg) translateY(-1px); }
}

/* ═══════════════════════════════════════════════════════════════
   TAB ICON ANIMATIONS - VOICES (Brain)
   ═══════════════════════════════════════════════════════════════ */

/* Generating voices - thinking animation */
.ie-tab[data-tab="voices"].voices-generating i {
    animation: thinking 0.8s ease-in-out infinite;
    color: #d4a5d9;
}

/* New voices ready - gentle glow */
.ie-tab[data-tab="voices"].voices-ready i {
    animation: glow-pulse 2s ease-in-out infinite;
    color: #e8c8eb;
}

/* ═══════════════════════════════════════════════════════════════
   TAB ICON ANIMATIONS - CABINET (Thoughts)
   ═══════════════════════════════════════════════════════════════ */

/* Thought ready to internalize - sparkle */
.ie-tab[data-tab="cabinet"].thought-ready i {
    animation: sparkle 1.5s ease-in-out infinite;
    color: #8ed4f0;
}

/* Thought just discovered - shake then settle */
.ie-tab[data-tab="cabinet"].thought-discovered i {
    animation: shake 0.5s ease-in-out;
}

/* Research in progress - gentle pulse */
.ie-tab[data-tab="cabinet"].researching i {
    animation: gentle-pulse 2s ease-in-out infinite;
    opacity: 0.8;
}

/* ═══════════════════════════════════════════════════════════════
   TAB ICON ANIMATIONS - STATUS (Health/Vitals)
   ═══════════════════════════════════════════════════════════════ */

/* Low health - heartbeat */
.ie-tab[data-tab="status"].health-low i {
    animation: heartbeat 1.2s ease-in-out infinite;
    color: #e88;
}

/* Critical health - fast heartbeat */
.ie-tab[data-tab="status"].health-critical i {
    animation: heartbeat-fast 0.8s ease-in-out infinite;
    color: #ff5555;
    filter: drop-shadow(0 0 4px rgba(255, 85, 85, 0.6));
}

/* Low morale - sad pulse */
.ie-tab[data-tab="status"].morale-low i {
    animation: gentle-pulse 3s ease-in-out infinite;
    filter: saturate(0.6) brightness(0.9);
}

/* Active conditions - subtle glow */
.ie-tab[data-tab="status"].condition-active i {
    animation: glow-pulse 3s ease-in-out infinite;
}

/* Horror/Pale active - ominous */
.ie-tab[data-tab="status"].condition-horror i {
    animation: urgent-pulse 1s ease-in-out infinite;
    color: #c0392b !important;
}

.ie-tab[data-tab="status"].condition-pale i {
    animation: thinking 2s ease-in-out infinite;
    filter: saturate(0) brightness(1.5);
}

/* ═══════════════════════════════════════════════════════════════
   TAB ICON ANIMATIONS - LEDGER (Cases/Notes)
   ═══════════════════════════════════════════════════════════════ */

/* New case or update - page flip */
.ie-tab[data-tab="ledger"].case-updated i {
    animation: page-flip 0.6s ease-in-out;
}

/* Unread content - gentle float */
.ie-tab[data-tab="ledger"].has-unread i {
    animation: float 2s ease-in-out infinite;
    color: #e8d060;
}

/* ═══════════════════════════════════════════════════════════════
   TAB ICON ANIMATIONS - INVENTORY
   ═══════════════════════════════════════════════════════════════ */

/* Item just added - bounce */
.ie-tab[data-tab="inventory"].item-added i {
    animation: shake 0.4s ease-in-out;
}

/* Low on consumables - subtle warning */
.ie-tab[data-tab="inventory"].low-supplies i {
    animation: gentle-pulse 2.5s ease-in-out infinite;
    filter: saturate(0.7);
}

/* ═══════════════════════════════════════════════════════════════
   INVENTORY SUBTAB ANIMATIONS (Radio lives here)
   ═══════════════════════════════════════════════════════════════ */

/* Radio playing - pulse the radio subtab button */
.inventory-sub-tab[data-subtab="radio"].radio-playing {
    animation: gentle-pulse 1s ease-in-out infinite;
    color: #4ade80;
    text-shadow: 0 0 8px rgba(74, 222, 128, 0.5);
}

/* Radio static/tuning */
.inventory-sub-tab[data-subtab="radio"].radio-static {
    animation: shake 0.3s ease-in-out infinite;
    opacity: 0.7;
}

/* ═══════════════════════════════════════════════════════════════
   FAB CONTEXTUAL ANIMATIONS - MAIN PANEL
   ═══════════════════════════════════════════════════════════════ */

/* Has unread notifications */
#inland-empire-fab.has-notification {
    animation: gentle-pulse 2s ease-in-out infinite;
}

#inland-empire-fab.has-notification .ie-fab-icon i {
    animation: float 1.5s ease-in-out infinite;
}

/* Urgent - critical health/morale */
#inland-empire-fab.urgent {
    animation: urgent-pulse 1.2s ease-in-out infinite;
}

#inland-empire-fab.urgent::before {
    background: #c0392b !important;
    animation: glow-pulse 1s ease-in-out infinite;
}

/* Voices generating */
#inland-empire-fab.voices-active .ie-fab-icon i {
    animation: thinking 1s ease-in-out infinite;
}

/* ═══════════════════════════════════════════════════════════════
   FAB CONTEXTUAL ANIMATIONS - INVESTIGATION
   ═══════════════════════════════════════════════════════════════ */

/* Scanning in progress */
#tribunal-investigation-fab.scanning {
    animation: paper-rustle 0.3s ease-in-out infinite;
}

#tribunal-investigation-fab.scanning .ie-fab-icon i {
    animation: thinking 0.6s ease-in-out infinite;
}

/* Investigation ready/available */
#tribunal-investigation-fab.ready {
    animation: gentle-pulse 2.5s ease-in-out infinite;
}

/* Found something interesting */
#tribunal-investigation-fab.found-clue {
    animation: shake 0.5s ease-in-out;
}

#tribunal-investigation-fab.found-clue .ie-fab-icon i {
    animation: sparkle 1s ease-in-out 2;
}

/* ═══════════════════════════════════════════════════════════════
   NOTIFICATION DOT ENHANCEMENTS
   ═══════════════════════════════════════════════════════════════ */

/* Urgent notification */
.ie-fab .fab-notification.urgent {
    background: #e74c3c;
    animation: urgent-pulse 0.8s ease-in-out infinite;
}

/* New content notification */
.ie-fab .fab-notification.new {
    background: #3498db;
    animation: gentle-pulse 1.5s ease-in-out infinite;
}

/* Thought ready notification */
.ie-fab .fab-notification.thought {
    background: var(--tab-int);
    animation: sparkle 2s ease-in-out infinite;
}

/* ═══════════════════════════════════════════════════════════════
   TAB BADGE/NOTIFICATION DOT
   Add via JS: <span class="tab-notification"></span> inside .ie-tab
   ═══════════════════════════════════════════════════════════════ */

.ie-tab .tab-notification {
    position: absolute;
    top: 4px;
    right: 4px;
    width: 8px;
    height: 8px;
    background: #e74c3c;
    border-radius: 50%;
    border: 1px solid rgba(0, 0, 0, 0.3);
    animation: gentle-pulse 1.5s ease-in-out infinite;
}

.ie-tab .tab-notification.thought {
    background: var(--tab-int);
}

.ie-tab .tab-notification.health {
    background: var(--tab-fys);
    animation: heartbeat 1.2s ease-in-out infinite;
}

.ie-tab .tab-notification.urgent {
    background: #c0392b;
    animation: urgent-pulse 0.8s ease-in-out infinite;
}

/* ═══════════════════════════════════════════════════════════════
   REDUCED MOTION - Respect user preferences
   ═══════════════════════════════════════════════════════════════ */

@media (prefers-reduced-motion: reduce) {
    .ie-tab i,
    .ie-fab,
    .ie-fab .ie-fab-icon i,
    .tab-notification,
    .fab-notification {
        animation: none !important;
    }
    
    /* Still show state via color/glow, just no motion */
    .ie-tab[data-tab="status"].health-critical i {
        color: #ff5555;
        filter: drop-shadow(0 0 4px rgba(255, 85, 85, 0.6));
    }
    
    #inland-empire-fab.urgent {
        box-shadow: 0 0 15px 3px rgba(192, 57, 43, 0.6);
    }
}
