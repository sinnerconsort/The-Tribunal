/**
 * The Tribunal - Drawer Dice Animations
 * ADDITIVE - Import after compartment.css
 */

/* ═══════════════════════════════════════════════════════════════
   INVESTIGATION FAB - LUCK INDICATOR
   Shows when drawer dice luck is active
   ═══════════════════════════════════════════════════════════════ */

/* Good luck - golden sparkle */
#tribunal-investigation-fab.luck-positive {
    animation: fabLuckPositive 2s ease-in-out infinite;
    box-shadow: 
        0 0 8px rgba(212, 165, 116, 0.6),
        0 0 16px rgba(155, 107, 158, 0.3);
}

#tribunal-investigation-fab.luck-positive::after {
    content: '✦';
    position: absolute;
    top: -4px;
    right: -4px;
    font-size: 12px;
    color: #d4a574;
    animation: sparkleFloat 1.5s ease-in-out infinite;
    text-shadow: 0 0 4px rgba(212, 165, 116, 0.8);
}

@keyframes fabLuckPositive {
    0%, 100% { 
        box-shadow: 
            0 0 8px rgba(212, 165, 116, 0.4),
            0 0 16px rgba(155, 107, 158, 0.2);
    }
    50% { 
        box-shadow: 
            0 0 12px rgba(212, 165, 116, 0.7),
            0 0 24px rgba(155, 107, 158, 0.4);
    }
}

@keyframes sparkleFloat {
    0%, 100% { 
        transform: translateY(0) rotate(0deg); 
        opacity: 1;
    }
    50% { 
        transform: translateY(-3px) rotate(15deg); 
        opacity: 0.7;
    }
}

/* Bad luck - red shadow */
#tribunal-investigation-fab.luck-negative {
    animation: fabLuckNegative 2s ease-in-out infinite;
}

#tribunal-investigation-fab.luck-negative::after {
    content: '✕';
    position: absolute;
    top: -4px;
    right: -4px;
    font-size: 10px;
    color: #b54b4b;
    animation: cursePulse 1s ease-in-out infinite;
    text-shadow: 0 0 4px rgba(181, 75, 75, 0.8);
}

@keyframes fabLuckNegative {
    0%, 100% { 
        box-shadow: 0 0 8px rgba(181, 75, 75, 0.3);
    }
    50% { 
        box-shadow: 0 0 12px rgba(181, 75, 75, 0.5);
    }
}

@keyframes cursePulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
}

/* ═══════════════════════════════════════════════════════════════
   DICE INTERACTION STATES
   ═══════════════════════════════════════════════════════════════ */

.compartment-dice {
    cursor: pointer;
    transition: transform 0.2s ease;
    perspective: 200px;
}

.compartment-dice:hover {
    transform: scale(1.05);
}

.compartment-dice:active {
    transform: scale(0.98);
}

/* ═══════════════════════════════════════════════════════════════
   DICE ROLLING ANIMATION - Actual tumble/spin!
   ═══════════════════════════════════════════════════════════════ */

.siren-die {
    transition: transform 0.1s ease;
    transform-style: preserve-3d;
}

/* Red die - tumbles left */
.siren-die.die-red.die-rolling {
    animation: diceTumbleRed 0.7s cubic-bezier(0.25, 0.1, 0.25, 1);
}

@keyframes diceTumbleRed {
    0% { 
        transform: rotate(-18deg) translateY(0); 
    }
    15% { 
        transform: rotate(-40deg) translateY(-12px) rotateX(90deg); 
    }
    30% { 
        transform: rotate(-10deg) translateY(-8px) rotateX(180deg) rotateY(45deg); 
    }
    45% { 
        transform: rotate(-55deg) translateY(-15px) rotateX(270deg) rotateY(90deg); 
    }
    60% { 
        transform: rotate(-25deg) translateY(-6px) rotateX(360deg) rotateY(135deg); 
    }
    75% { 
        transform: rotate(-35deg) translateY(-3px) rotateX(405deg) rotateY(160deg); 
    }
    90% { 
        transform: rotate(-20deg) translateY(-1px) rotateX(430deg); 
    }
    100% { 
        transform: rotate(-18deg) translateY(0) rotateX(360deg); 
    }
}

/* Blue die - tumbles right (offset timing) */
.siren-die.die-blue.die-rolling {
    animation: diceTumbleBlue 0.7s cubic-bezier(0.25, 0.1, 0.25, 1) 0.05s;
}

@keyframes diceTumbleBlue {
    0% { 
        transform: rotate(10deg) translateY(0); 
    }
    15% { 
        transform: rotate(35deg) translateY(-14px) rotateX(-90deg) rotateY(-30deg); 
    }
    30% { 
        transform: rotate(5deg) translateY(-10px) rotateX(-180deg) rotateY(-60deg); 
    }
    45% { 
        transform: rotate(50deg) translateY(-16px) rotateX(-270deg) rotateY(-90deg); 
    }
    60% { 
        transform: rotate(20deg) translateY(-7px) rotateX(-360deg) rotateY(-120deg); 
    }
    75% { 
        transform: rotate(30deg) translateY(-3px) rotateX(-405deg) rotateY(-150deg); 
    }
    90% { 
        transform: rotate(12deg) translateY(-1px) rotateX(-430deg); 
    }
    100% { 
        transform: rotate(10deg) translateY(0) rotateX(-360deg); 
    }
}

/* Bounce settle at the end */
.siren-die.die-result {
    animation: diceSettle 0.4s ease-out;
}

@keyframes diceSettle {
    0% { transform: scale(1.1); filter: brightness(1.3); }
    40% { transform: scale(0.95); }
    70% { transform: scale(1.02); }
    100% { transform: scale(1); filter: brightness(1); }
}

/* ═══════════════════════════════════════════════════════════════
   CRIT ROLL EFFECTS
   ═══════════════════════════════════════════════════════════════ */

/* Snake Eyes glow - red */
.compartment-dice.crit-fail .siren-die {
    animation: snakeEyesGlow 1s ease-in-out;
}

@keyframes snakeEyesGlow {
    0% { box-shadow: 0 0 0 rgba(180, 75, 75, 0); }
    50% { box-shadow: 0 0 15px rgba(180, 75, 75, 0.6), 0 0 30px rgba(180, 75, 75, 0.3); }
    100% { box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5); }
}

/* Boxcars glow - gold/purple */
.compartment-dice.crit-success .siren-die {
    animation: boxcarsGlow 1s ease-in-out;
}

@keyframes boxcarsGlow {
    0% { box-shadow: 0 0 0 rgba(155, 107, 158, 0); }
    50% { box-shadow: 0 0 15px rgba(212, 165, 116, 0.6), 0 0 30px rgba(155, 107, 158, 0.4); }
    100% { box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5); }
}

/* ═══════════════════════════════════════════════════════════════
   DICE RESULT DISPLAY IN COMMENTARY
   ═══════════════════════════════════════════════════════════════ */

.dice-result-display {
    font-family: 'IBM Plex Mono', 'Courier New', monospace;
    letter-spacing: 2px;
    display: block;
    margin-bottom: 6px;
}

/* Commentary with dice result styling */
.compartment-commentary {
    transition: border-color 0.3s ease;
}

/* Color border based on roll type */
.compartment-commentary.roll-crit-fail {
    border-left-color: var(--physique, #b54b4b);
}

.compartment-commentary.roll-crit-success {
    border-left-color: var(--psyche, #9b6b9e);
}

.compartment-commentary.roll-normal {
    border-left-color: var(--ie-accent, #d4a574);
}

/* ═══════════════════════════════════════════════════════════════
   FORTUNE BUTTON STATES
   ═══════════════════════════════════════════════════════════════ */

.draw-fortune-btn.drawing {
    pointer-events: none;
    opacity: 0.5;
}

/* Fortune reveal animation */
.letter-text {
    transition: color 0.3s ease, opacity 0.3s ease;
}

.letter-signature {
    transition: color 0.3s ease;
}

/* ═══════════════════════════════════════════════════════════════
   LUCK INDICATOR (optional - shows active luck modifier)
   ═══════════════════════════════════════════════════════════════ */

.luck-indicator {
    position: absolute;
    top: 8px;
    right: 8px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 9px;
    padding: 2px 6px;
    border-radius: 2px;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
}

.luck-indicator.active {
    opacity: 1;
}

.luck-indicator.luck-positive {
    color: var(--psyche, #9b6b9e);
    background: rgba(155, 107, 158, 0.15);
    border: 1px solid rgba(155, 107, 158, 0.3);
}

.luck-indicator.luck-negative {
    color: var(--physique, #b54b4b);
    background: rgba(181, 75, 75, 0.15);
    border: 1px solid rgba(181, 75, 75, 0.3);
}

/* ═══════════════════════════════════════════════════════════════
   TOOLTIP FOR DICE (shows "Roll the dice")
   ═══════════════════════════════════════════════════════════════ */

.compartment-dice::after {
    content: 'roll';
    position: absolute;
    bottom: -18px;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'IBM Plex Mono', monospace;
    font-size: 8px;
    color: rgba(212, 165, 116, 0.3);
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
}

.compartment-dice:hover::after {
    opacity: 1;
}

.compartment-dice.rolling::after {
    opacity: 0;
}
