/**
 * The Tribunal - Condition Effects
 * Visual overlays for consumption and health states
 * 
 * SEPARATE from weather - these stack ON TOP
 * Weather: z-index 9998
 * Conditions: z-index 9999
 */

/* ═══════════════════════════════════════════════════════════════
   CONTAINER - Sits above weather
   ═══════════════════════════════════════════════════════════════ */

.tribunal-condition-layer {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 9999;
    overflow: hidden;
}

/* ═══════════════════════════════════════════════════════════════
   CIGARETTE - Ember Glow + Smoke
   ═══════════════════════════════════════════════════════════════ */

.effect-smoke-active .smoke-ember {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 8px;
    height: 8px;
    background: radial-gradient(circle, #ff6b35 0%, #ff4500 50%, transparent 70%);
    border-radius: 50%;
    animation: ember-flicker 0.3s ease-in-out infinite alternate;
    box-shadow: 
        0 0 10px #ff6b35,
        0 0 20px #ff4500,
        0 0 30px rgba(255, 69, 0, 0.5);
}

@keyframes ember-flicker {
    0% { 
        opacity: 0.8; 
        transform: translateX(-50%) scale(1);
    }
    100% { 
        opacity: 1; 
        transform: translateX(-50%) scale(1.2);
    }
}

/* Smoke particles */
.effect-smoke-active .smoke-particle {
    position: fixed;
    bottom: 30px;
    left: 50%;
    width: 4px;
    height: 4px;
    background: rgba(200, 200, 200, 0.6);
    border-radius: 50%;
    filter: blur(2px);
    animation: smoke-rise 3s ease-out forwards;
}

.effect-smoke-active .smoke-particle:nth-child(2) { animation-delay: 0.3s; left: calc(50% - 5px); }
.effect-smoke-active .smoke-particle:nth-child(3) { animation-delay: 0.6s; left: calc(50% + 5px); }
.effect-smoke-active .smoke-particle:nth-child(4) { animation-delay: 0.9s; left: calc(50% - 8px); }
.effect-smoke-active .smoke-particle:nth-child(5) { animation-delay: 1.2s; left: calc(50% + 8px); }
.effect-smoke-active .smoke-particle:nth-child(6) { animation-delay: 1.5s; }
.effect-smoke-active .smoke-particle:nth-child(7) { animation-delay: 1.8s; left: calc(50% - 3px); }
.effect-smoke-active .smoke-particle:nth-child(8) { animation-delay: 2.1s; left: calc(50% + 3px); }

@keyframes smoke-rise {
    0% {
        opacity: 0.7;
        transform: translateX(-50%) translateY(0) scale(1);
    }
    50% {
        opacity: 0.4;
    }
    100% {
        opacity: 0;
        transform: translateX(calc(-50% + var(--drift, 10px))) translateY(-150px) scale(2.5);
    }
}

.smoke-particle:nth-child(odd) { --drift: -15px; }
.smoke-particle:nth-child(even) { --drift: 12px; }
.smoke-particle:nth-child(3n) { --drift: -8px; }

/* ═══════════════════════════════════════════════════════════════
   ALCOHOL - Warm Vignette + Blur
   ═══════════════════════════════════════════════════════════════ */

.effect-drunk-active::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
        ellipse at center,
        transparent 40%,
        rgba(180, 120, 60, 0.15) 70%,
        rgba(139, 69, 19, 0.25) 100%
    );
    animation: drunk-pulse 4s ease-in-out infinite;
    pointer-events: none;
}

@keyframes drunk-pulse {
    0%, 100% { opacity: 0.8; }
    50% { opacity: 1; }
}

/* Subtle sway effect on the whole screen */
.effect-drunk-active {
    animation: drunk-sway 6s ease-in-out infinite;
}

@keyframes drunk-sway {
    0%, 100% { transform: rotate(0deg) scale(1); }
    25% { transform: rotate(0.3deg) scale(1.002); }
    75% { transform: rotate(-0.3deg) scale(1.002); }
}

/* ═══════════════════════════════════════════════════════════════
   STIMULANT - Edge Sparkle + Jitter
   ═══════════════════════════════════════════════════════════════ */

.effect-stimulant-active {
    animation: stim-jitter 0.1s linear infinite;
}

@keyframes stim-jitter {
    0% { transform: translate(0, 0); }
    25% { transform: translate(0.5px, -0.5px); }
    50% { transform: translate(-0.5px, 0.5px); }
    75% { transform: translate(0.5px, 0.5px); }
    100% { transform: translate(-0.5px, -0.5px); }
}

/* Sparkle/static at edges */
.effect-stimulant-active::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 0% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 100% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 50% 0%, rgba(255, 255, 255, 0.08) 0%, transparent 15%),
        radial-gradient(circle at 50% 100%, rgba(255, 255, 255, 0.08) 0%, transparent 15%);
    animation: stim-sparkle 0.5s steps(3) infinite;
    pointer-events: none;
}

@keyframes stim-sparkle {
    0% { opacity: 0.3; }
    50% { opacity: 0.8; }
    100% { opacity: 0.3; }
}

/* ═══════════════════════════════════════════════════════════════
   LOW HEALTH - Vision Darkening
   ═══════════════════════════════════════════════════════════════ */

.effect-low-health::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
        ellipse at center,
        transparent 30%,
        rgba(0, 0, 0, 0.3) 60%,
        rgba(0, 0, 0, 0.6) 100%
    );
    animation: health-pulse 3s ease-in-out infinite;
    pointer-events: none;
}

@keyframes health-pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
}

/* ═══════════════════════════════════════════════════════════════
   DYING - Red Pulse + Tunnel Vision
   ═══════════════════════════════════════════════════════════════ */

.effect-dying::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
        ellipse at center,
        transparent 20%,
        rgba(80, 0, 0, 0.4) 50%,
        rgba(40, 0, 0, 0.8) 100%
    );
    animation: dying-pulse 1.5s ease-in-out infinite;
    pointer-events: none;
}

@keyframes dying-pulse {
    0%, 100% { 
        opacity: 0.6;
        background: radial-gradient(
            ellipse at center,
            transparent 20%,
            rgba(80, 0, 0, 0.4) 50%,
            rgba(40, 0, 0, 0.8) 100%
        );
    }
    50% { 
        opacity: 1;
        background: radial-gradient(
            ellipse at center,
            transparent 15%,
            rgba(120, 0, 0, 0.5) 45%,
            rgba(60, 0, 0, 0.9) 100%
        );
    }
}

/* Heartbeat red flash at edges */
.effect-dying::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    box-shadow: inset 0 0 100px rgba(255, 0, 0, 0.3);
    animation: heartbeat-flash 1s ease-in-out infinite;
    pointer-events: none;
}

@keyframes heartbeat-flash {
    0%, 100% { opacity: 0; }
    20% { opacity: 1; }
    40% { opacity: 0; }
}

/* ═══════════════════════════════════════════════════════════════
   HORROR - Now uses particle-based system (see .effect-horror-active)
   ═══════════════════════════════════════════════════════════════ */

/* ═══════════════════════════════════════════════════════════════
   LOW MORALE - Desaturated/Gray
   ═══════════════════════════════════════════════════════════════ */

.effect-low-morale {
    filter: saturate(0.5) brightness(0.9);
    transition: filter 1s ease;
}

.effect-low-morale::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(50, 50, 60, 0.15);
    pointer-events: none;
}

/* ═══════════════════════════════════════════════════════════════
   HORROR - Vignette + Heartbeat + Blood Drips + Flicker
   (Moved from weather - can now overlap with rain/snow!)
   ═══════════════════════════════════════════════════════════════ */

.effect-horror-active .fx-horror-vignette {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse at center, transparent 30%, rgba(30, 0, 0, 0.4) 100%);
    pointer-events: none;
}

.effect-horror-active .fx-horror-heartbeat {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse at center, rgba(100, 0, 0, 0.25) 0%, transparent 60%);
    animation: horror-heartbeat 1.8s ease-in-out infinite;
    pointer-events: none;
}

@keyframes horror-heartbeat {
    0%, 100% { opacity: 0.15; transform: scale(1); }
    15% { opacity: 0.5; transform: scale(1.03); }
    30% { opacity: 0.2; transform: scale(1); }
    45% { opacity: 0.4; transform: scale(1.02); }
}

.effect-horror-active .fx-horror-flicker {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0);
    animation: horror-flicker 4s steps(1) infinite;
    pointer-events: none;
}

@keyframes horror-flicker {
    0%, 100% { background: rgba(0, 0, 0, 0); }
    45% { background: rgba(0, 0, 0, 0); }
    46% { background: rgba(0, 0, 0, 0.15); }
    47% { background: rgba(0, 0, 0, 0); }
    48% { background: rgba(0, 0, 0, 0.1); }
    49% { background: rgba(0, 0, 0, 0); }
}

/* Blood drips */
.effect-horror-active .fx-blood-drip {
    position: fixed;
    width: 3px;
    background: linear-gradient(180deg, rgba(140, 20, 20, 0.85) 0%, rgba(100, 10, 10, 0.5) 100%);
    border-radius: 0 0 50% 50%;
    animation: blood-drip linear infinite;
    pointer-events: none;
}

@keyframes blood-drip {
    0% { transform: translateY(-80px); height: 0; opacity: 0; }
    10% { height: 40px; opacity: 0.9; }
    90% { opacity: 0.6; }
    100% { transform: translateY(100vh); height: 60px; opacity: 0; }
}

/* ═══════════════════════════════════════════════════════════════
   THE PALE - Void + Static + Shimmer + Memory Wisps
   (Dreaming/Unconscious state - now separate from weather!)
   ═══════════════════════════════════════════════════════════════ */

.effect-pale-active .fx-pale-void {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
        ellipse at center,
        rgba(200, 210, 220, 0.2) 0%,
        rgba(180, 190, 200, 0.12) 50%,
        rgba(160, 170, 180, 0.06) 100%
    );
    pointer-events: none;
}

.effect-pale-active .fx-pale-static {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(220, 230, 240, 0.06) 2px,
        rgba(220, 230, 240, 0.06) 4px
    );
    animation: pale-static 0.15s linear infinite;
    pointer-events: none;
}

@keyframes pale-static {
    0% { opacity: 0.4; }
    50% { opacity: 0.6; }
    100% { opacity: 0.4; }
}

.effect-pale-active .fx-pale-shimmer {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(220, 230, 240, 0.12) 50%,
        transparent 100%
    );
    animation: pale-shimmer 10s ease-in-out infinite;
    pointer-events: none;
}

@keyframes pale-shimmer {
    0%, 100% { transform: translateX(-100%); opacity: 0; }
    50% { transform: translateX(100%); opacity: 1; }
}

/* Memory wisps - floating orbs */
.effect-pale-active .fx-memory-wisp {
    position: fixed;
    width: 100px;
    height: 100px;
    background: radial-gradient(circle, rgba(200, 210, 220, 0.25) 0%, transparent 70%);
    border-radius: 50%;
    animation: memory-wisp ease-in-out infinite;
    pointer-events: none;
}

@keyframes memory-wisp {
    0%, 100% { transform: scale(1); opacity: 0.3; }
    50% { transform: scale(1.4); opacity: 0.5; }
}

/* Thought symbols - floating text fragments */
.effect-pale-active .fx-thought-symbol {
    position: fixed;
    font-family: serif;
    font-size: 16px;
    color: rgba(180, 190, 200, 0.5);
    animation: thought-symbol ease-in-out infinite;
    pointer-events: none;
}

@keyframes thought-symbol {
    0%, 100% { opacity: 0; transform: translateY(0); }
    50% { opacity: 0.7; transform: translateY(-25px); }
}

/* ═══════════════════════════════════════════════════════════════
   FADE IN/OUT TRANSITIONS
   ═══════════════════════════════════════════════════════════════ */

.tribunal-condition-layer.fade-in {
    animation: condition-fade-in 0.5s ease forwards;
}

.tribunal-condition-layer.fade-out {
    animation: condition-fade-out 0.5s ease forwards;
}

@keyframes condition-fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes condition-fade-out {
    from { opacity: 1; }
    to { opacity: 0; }
}
